@import "../../pfe-sass/pfe-sass";

$LOCAL: card;

:host {
  --pfe-card--padding:                          calc(#{pfe-var(container-spacer)} * 2); // 2x `container-spacer`
  --pfe-card_header--size:                      #{pfe-var(font-size--heading--gamma)};
  --pfe-card--bg:                               #{pfe-color(surface--base)};

  // Text colors
  --pfe-broadcasted--color--text:               #{get-ui-color(base, text)};
  --pfe-broadcasted--color--ui-link:            #{get-ui-color(base, ui-link)};
  --pfe-broadcasted--color--ui-link--visited:   #{get-ui-color(base, ui-link, visited)};
  --pfe-broadcasted--color--ui-link--hover:     #{get-ui-color(base, ui-link, hover)};
  --pfe-broadcasted--color--ui-link--focus:     #{get-ui-color(base, ui-link, focus)};

  display: flex;
  flex-direction: column;
  justify-items: flex-start;
  // This allows the card to fill it's container if necessary
  align-self: stretch;

  padding: var(--pfe-card--padding);
  border: pfe-var(surface--border-width)
          pfe-var(surface--border-style)
          transparent;
  border-radius: pfe-var(surface--border-radius);

  // Base colors
  background: var(--pfe-card--bg);
  color: var(--pfe-broadcasted--color--text);
}

:host([color="dark"]) {
  --pfe-card--bg:                               #{pfe-color(surface--darker)};
  --pfe-broadcasted--color--text:               #{get-ui-color(darker, text)};
  --pfe-broadcasted--color--ui-link:            #{get-ui-color(darker, ui-link)};
  --pfe-broadcasted--color--ui-link--visited:   #{get-ui-color(darker, ui-link, visited)};
  --pfe-broadcasted--color--ui-link--hover:     #{get-ui-color(darker, ui-link, hover)};
  --pfe-broadcasted--color--ui-link--focus:     #{get-ui-color(darker, ui-link, focus)};
}

:host([color="light"]) {
  --pfe-card--bg:                               #{pfe-color(surface--lighter)};
  --pfe-broadcasted--color--text:               #{get-ui-color(lighter, text)};
  --pfe-broadcasted--color--ui-link:            #{get-ui-color(lighter, ui-link)};
  --pfe-broadcasted--color--ui-link--visited:   #{get-ui-color(lighter, ui-link, visited)};
  --pfe-broadcasted--color--ui-link--hover:     #{get-ui-color(lighter, ui-link, hover)};
  --pfe-broadcasted--color--ui-link--focus:     #{get-ui-color(lighter, ui-link, focus)};
}

// Calls :host([color=""]) for each color value
@include set-surface-colors(
  $prefix: "",
  $properties: bg
);

:host([size="small"]) {
  --pfe-card--padding:        #{pfe-var(container-spacer)};
}

.pfe-card__header,
.pfe-card__body,
.pfe-card__footer {
  display: block;
  margin: 0;
}

.pfe-card__header::slotted(h1:first-child),
.pfe-card__header::slotted(h2:first-child),
.pfe-card__header::slotted(h3:first-child),
.pfe-card__header::slotted(h4:first-child),
.pfe-card__header::slotted(h5:first-child),
.pfe-card__header::slotted(h6:first-child) {
  margin-top: 0 !important; // Specificity issue. Why?!
  font-size: var(--pfe-card_header--size);
}

.pfe-card__body::slotted(*:nth-child(2)) { // child pseudo-selectors appear to be based on slotted code before upgrade.
  margin-top: 0 !important;
}

.pfe-card__footer {
  // margin-top: pfe-var(container-spacer);
  margin-top: auto; // This allows the footer to move to the very bottom
  justify-self: flex-end;
}
